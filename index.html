<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#e97a95" />
  <title>–î–µ—Ç—Å–∫–∞—è –û–¥–µ–∂–¥–∞</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--pink:#e97a95;--dark:#2b2533;--green:#12c96b;--bg:linear-gradient(135deg,#fdf1f4 0%,#f4fdf8 50%,#fdf5e6 100%);--shadow:0 4px 20px rgba(0,0,0,.06);--r:12px}
    *{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,sans-serif;-webkit-tap-highlight-color:transparent}
    body{background:var(--bg);color:var(--dark);min-height:100vh;overflow-x:hidden}
    .hero{padding:52px 14px 18px;text-align:center;position:relative;overflow:hidden}
    .hero::before,.hero::after{content:"";position:absolute;border-radius:50%;pointer-events:none;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,.9),rgba(253,224,233,.25))}
    .hero::before{width:220px;height:220px;left:-70px;top:-70px}
    .hero::after{width:160px;height:160px;right:-50px;bottom:-50px}
    .hero h1{font-size:clamp(2rem,9vw,4rem);line-height:1.08;margin-bottom:8px}
    .hero .pink{color:var(--pink);font-weight:600}
    .hero .dark{color:var(--dark);font-weight:800}
    .hero p{color:#888;font-size:clamp(11px,3.5vw,14px)}
    .wrap{max-width:1200px;margin:0 auto;padding:10px 10px 84px}
    .title{text-align:center;font-size:clamp(1.05rem,4vw,1.55rem);font-weight:500;margin:10px 0 18px}
    .title::after{content:"";display:block;width:40px;height:2px;background:var(--pink);margin:8px auto 0}
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
    @media(max-width:860px){.grid{grid-template-columns:repeat(3,1fr);gap:7px}}
    .card{background:#fff;border-radius:var(--r);overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column;transition:transform .2s ease}
    .card:active{transform:scale(.97)}
    .img{width:100%;aspect-ratio:1/1;object-fit:cover;display:block;cursor:zoom-in}
    .body{padding:clamp(7px,2vw,12px);display:flex;flex-direction:column;gap:6px;flex:1}
    .name{font-size:clamp(10px,2.7vw,14px);font-weight:800;line-height:1.2}
    .desc{font-size:clamp(9px,2.2vw,12px);color:#666;line-height:1.3;flex:1;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
    .btn{display:flex;align-items:center;justify-content:center;gap:6px;background:var(--green);color:#fff;text-decoration:none;border:0;border-radius:18px;padding:clamp(6px,2vw,10px);font-weight:800;font-size:clamp(9px,2vw,12px)}
    .btn svg{width:13px;height:13px;fill:currentColor}
    #lb{position:fixed;inset:0;background:rgba(0,0,0,.9);z-index:9999;display:none;align-items:center;justify-content:center;perspective:1200px;padding:20px}
    #lb.open{display:flex}
    #lbClose{position:absolute;top:12px;right:18px;color:#fff;font-size:40px;line-height:1;cursor:pointer}
    #lbImg{max-width:93vw;max-height:86vh;border-radius:16px;box-shadow:0 40px 80px rgba(0,0,0,.7);cursor:zoom-out;opacity:0;transform:rotateX(70deg) scale(.3) translateY(80px);transition:transform .55s cubic-bezier(.175,.885,.32,1.275),opacity .4s ease}
    #lb.open #lbImg{opacity:1;transform:rotateX(0) scale(1) translateY(0)}
    #gear{position:fixed;left:18px;bottom:18px;width:46px;height:46px;border-radius:50%;border:0;background:rgba(0,0,0,.08);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:100;font-size:22px;transition:.3s}
    #gear:hover{background:var(--pink);transform:rotate(90deg)}
    #screenClient{display:block}
    #screenLogin{display:none;min-height:100vh;align-items:center;justify-content:center;padding:20px}
    #screenAdmin{display:none;min-height:100vh;background:#f5f5f5;padding:12px}
    .loginCard{width:100%;max-width:360px;background:#fff;border-radius:20px;box-shadow:0 10px 40px rgba(0,0,0,.08);padding:34px 28px}
    .loginCard h2{text-align:center;margin-bottom:18px;font-size:1.2rem}
    .inp{width:100%;padding:12px 14px;border:1.5px solid #eee;border-radius:10px;margin-bottom:10px;font-size:14px}
    .inp:focus{outline:none;border-color:var(--pink)}
    .btnPink{width:100%;padding:13px;border:0;border-radius:10px;background:var(--pink);color:#fff;font-weight:800;cursor:pointer;font-size:14px}
    .btnGray{width:100%;padding:11px;border:0;border-radius:10px;background:#f0f0f0;color:#333;font-weight:700;cursor:pointer;margin-top:8px;font-size:14px}
    .errMsg{color:#ff4757;font-size:12px;text-align:center;margin-top:8px;display:none}
    .topbar{background:#fff;border-radius:var(--r);box-shadow:var(--shadow);padding:14px;display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .topbar h2{font-size:1rem}
    .row{display:flex;gap:8px}
    .btnSm{padding:8px 12px;border:0;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer}
    .btnSm.pink{background:var(--pink);color:#fff}
    .btnSm.gray{background:#eee;color:#333}
    .panel{display:none;background:#fff;border-radius:var(--r);box-shadow:var(--shadow);padding:16px;margin-bottom:12px}
    .panel h3{margin-bottom:12px;font-size:1rem}
    .lab{font-size:10px;font-weight:900;color:#999;text-transform:uppercase;margin-bottom:4px;display:block}
    textarea.inp{resize:none}
    #prev{width:84px;height:84px;border-radius:10px;object-fit:cover;display:none;margin-top:8px}
    .actions{display:flex;gap:8px;margin-top:12px}
    .actions button{flex:1;padding:12px}
    .aItem{background:#fff;border-radius:10px;padding:12px;display:flex;gap:12px;align-items:center;margin-bottom:9px;box-shadow:0 2px 8px rgba(0,0,0,.04)}
    .aItem img{width:54px;height:54px;border-radius:8px;object-fit:cover}
    .aInfo{flex:1;min-width:0}
    .aName{font-weight:900;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .aMeta{font-size:11px;color:#888;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .aAct{display:flex;gap:6px}
    .iconBtn{border:0;border-radius:8px;padding:8px 10px;cursor:pointer;font-weight:900}
    .iconBtn.edit{background:#eee}
    .iconBtn.del{background:#ff4757;color:#fff}
    #toast{position:fixed;left:50%;bottom:76px;transform:translateX(-50%);background:#2b2533;color:#fff;padding:10px 18px;border-radius:22px;font-size:13px;font-weight:600;z-index:10000;opacity:0;pointer-events:none;transition:opacity .25s ease;max-width:90vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    #toast.show{opacity:1}
    .loader{grid-column:1/-1;text-align:center;padding:44px;color:var(--pink);font-weight:800}
    .errBox{grid-column:1/-1;text-align:center;padding:24px;color:#ff4757;font-weight:700;font-size:13px;background:#fff5f5;border-radius:12px;margin:10px}
    .spin{display:inline-block;width:28px;height:28px;border:3px solid rgba(233,122,149,.2);border-top-color:var(--pink);border-radius:50%;animation:rot .7s linear infinite;margin-bottom:8px}
    @keyframes rot{to{transform:rotate(360deg)}}
  </style>
</head>
<body>

  <!-- CLIENT -->
  <div id="screenClient">
    <div class="hero">
      <h1><span class="pink">–î–µ—Ç—Å–∫–∞—è</span><br><span class="dark">–û–¥–µ–∂–¥–∞</span></h1>
      <p>–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∏ —Å—Ç–∏–ª—å–Ω–∞—è –æ–¥–µ–∂–¥–∞ –¥–ª—è –≤–∞—à–∏—Ö –º–∞–ª—ã—à–µ–π ‚ú®</p>
    </div>
    <div class="wrap">
      <div class="title">–ù–∞—à–∏ —Ç–æ–≤–∞—Ä—ã</div>
      <div id="grid" class="grid">
        <div class="loader"><span class="spin"></span><br>–ó–∞–≥—Ä—É–∑–∫–∞...</div>
      </div>
    </div>
    <button id="gear" type="button">‚öôÔ∏è</button>
  </div>

  <!-- LIGHTBOX -->
  <div id="lb" role="dialog" aria-modal="true">
    <div id="lbClose">&times;</div>
    <img id="lbImg" alt="–§–æ—Ç–æ" />
  </div>

  <!-- LOGIN -->
  <div id="screenLogin">
    <div class="loginCard">
      <h2>üîê –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É</h2>
      <input id="login" class="inp" placeholder="–õ–æ–≥–∏–Ω" autocomplete="off" />
      <input id="pass"  class="inp" placeholder="–ü–∞—Ä–æ–ª—å" type="password" autocomplete="new-password" />
      <button id="btnLogin"  class="btnPink" type="button">–í–æ–π—Ç–∏</button>
      <button id="btnCancel" class="btnGray" type="button">–û—Ç–º–µ–Ω–∞</button>
      <div id="errMsg" class="errMsg">‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å</div>
    </div>
  </div>

  <!-- ADMIN -->
  <div id="screenAdmin">
    <div class="topbar">
      <h2>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>
      <div class="row">
        <button id="btnOpenForm" class="btnSm pink" type="button">+ –î–æ–±–∞–≤–∏—Ç—å</button>
        <button id="btnLogout"   class="btnSm gray" type="button">–í—ã–π—Ç–∏</button>
      </div>
    </div>
    <div id="panel" class="panel">
      <h3 id="formTitle">–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
      <input id="pid" type="hidden" />
      <label class="lab">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
      <input id="ptitle" class="inp" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–æ—Å–æ—á–∫–∏" />
      <label class="lab">–û–ø–∏—Å–∞–Ω–∏–µ</label>
      <textarea id="pdesc" class="inp" rows="3" placeholder="–†–∞–∑–º–µ—Ä, —Å–æ—Å—Ç–∞–≤, —Ü–µ–Ω–∞..."></textarea>
      <label class="lab">–°—Å—ã–ª–∫–∞ WhatsApp / Telegram</label>
      <input id="plink" class="inp" placeholder="https://wa.me/..." />
      <label class="lab">–§–æ—Ç–æ</label>
      <input id="pimg" class="inp" type="file" accept="image/*" />
      <img id="prev" alt="preview" />
      <div class="actions">
        <button id="btnSave"      class="btnSm pink" type="button">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="btnCloseForm" class="btnSm gray" type="button">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
    <div id="alist"></div>
  </div>

  <div id="toast"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import {
      getFirestore, collection, getDocs, addDoc,
      updateDoc, deleteDoc, doc
    } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

    // ‚úÖ –û–ë–ù–û–í–õ–Å–ù–ù–´–ô appId: 8b875c57f152fa6cee81b4
    const firebaseConfig = {
      apiKey:            "AIzaSyDCj2WqkiH0o0UerQLLgHZGq2YwOB0u98I",
      authDomain:        "detskaya-odejda.firebaseapp.com",
      projectId:         "detskaya-odejda",
      storageBucket:     "detskaya-odejda.firebasestorage.app",
      messagingSenderId: "1033590447197",
      appId:             "1:1033590447197:web:8b875c57f152fa6cee81b4"
    };

    const app = initializeApp(firebaseConfig);
    const db  = getFirestore(app);

    // –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Base64)
    const _L = "TGlkZXIwMDFA";
    const _P = "TGlkZXIwMDJA";
    function checkCreds(l, p){ return btoa(l) === _L && btoa(p) === _P; }

    const $ = id => document.getElementById(id);
    const chatSvg = `<svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.2L4 17.2V4h16v12z"/></svg>`;

    function toast(msg, ms = 2600){
      const t = $("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(() => t.classList.remove("show"), ms);
    }

    function show(screen){
      ["screenClient","screenLogin","screenAdmin"].forEach(s =>
        $(s).style.display = "none"
      );
      $(screen).style.display = "block";
    }

    function openLB(src){
      $("lbImg").src = "";
      $("lb").classList.add("open");
      setTimeout(() => { $("lbImg").src = src; }, 40);
    }
    function closeLB(){
      $("lb").classList.remove("open");
      setTimeout(() => { $("lbImg").src = ""; }, 500);
    }
    $("lb").addEventListener("click", closeLB);
    $("lbClose").addEventListener("click", e => { e.stopPropagation(); closeLB(); });
    $("lbImg").addEventListener("click", e => e.stopPropagation());

    function compressImage(file, maxPx = 900, quality = 0.75){
      return new Promise((resolve, reject) => {
        const r = new FileReader();
        r.onload = () => {
          const img = new Image();
          img.onload = () => {
            let w = img.width, h = img.height;
            if (w > maxPx || h > maxPx){
              if (w > h){ h = Math.round(h * maxPx / w); w = maxPx; }
              else      { w = Math.round(w * maxPx / h); h = maxPx; }
            }
            const c = document.createElement("canvas");
            c.width = w; c.height = h;
            c.getContext("2d").drawImage(img, 0, 0, w, h);
            resolve(c.toDataURL("image/jpeg", quality));
          };
          img.onerror = reject;
          img.src = r.result;
        };
        r.onerror = reject;
        r.readAsDataURL(file);
      });
    }

    $("pimg").addEventListener("change", async () => {
      const f = $("pimg").files?.[0];
      if (!f){ $("prev").style.display = "none"; return; }
      const b64 = await compressImage(f, 900, 0.78);
      $("prev").src = b64;
      $("prev").style.display = "block";
    });

    const productsCol = collection(db, "products");

    async function getProducts(){
      const snap = await getDocs(productsCol);
      return snap.docs
        .map(d => ({ id: d.id, ...d.data() }))
        .sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
    }

    async function loadProducts(){
      $("grid").innerHTML = `<div class="loader"><span class="spin"></span><br>–ó–∞–≥—Ä—É–∑–∫–∞...</div>`;
      try{
        renderGrid(await getProducts());
      }catch(e){
        $("grid").innerHTML = `<div class="errBox">‚ö†Ô∏è –û—à–∏–±–∫–∞: <b>${e.message}</b><br><br>–ü—Ä–æ–≤–µ—Ä—å Firestore Rules</div>`;
      }
    }

    function renderGrid(items){
      if (!items.length){
        $("grid").innerHTML = `<div class="loader">–ü–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ üõçÔ∏è</div>`;
        return;
      }
      $("grid").innerHTML = items.map(p => {
        const img  = p.image || "https://placehold.co/600x600?text=–ù–µ—Ç+—Ñ–æ—Ç–æ";
        const link = p.link  || "#";
        const name = (p.title || "").replaceAll("<","&lt;");
        const desc = (p.desc  || "").replaceAll("<","&lt;");
        return `
          <div class="card">
            <img class="img" src="${img}" alt="–§–æ—Ç–æ" loading="lazy" data-img="${img}">
            <div class="body">
              <div class="name">${name}</div>
              <div class="desc">${desc}</div>
              <a class="btn" target="_blank" href="${link}">${chatSvg} –ù–∞–ø–∏—Å–∞—Ç—å</a>
            </div>
          </div>`;
      }).join("");
      $("grid").querySelectorAll("[data-img]").forEach(el =>
        el.addEventListener("click", () => openLB(el.getAttribute("data-img")))
      );
    }

    let adminCache = [];

    async function loadAdminList(){
      $("alist").innerHTML = `<div class="loader"><span class="spin"></span><br>–ó–∞–≥—Ä—É–∑–∫–∞...</div>`;
      try{
        adminCache = await getProducts();
        renderAdmin(adminCache);
      }catch(e){
        $("alist").innerHTML = `<div class="errBox">‚ö†Ô∏è –û—à–∏–±–∫–∞: <b>${e.message}</b><br>–ü—Ä–æ–≤–µ—Ä—å Firestore Rules</div>`;
      }
    }

    function renderAdmin(items){
      if (!items.length){
        $("alist").innerHTML = `<div class="loader">–¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –ù–∞–∂–º–∏ "+ –î–æ–±–∞–≤–∏—Ç—å"</div>`;
        return;
      }
      $("alist").innerHTML = items.map(p => {
        const img  = p.image || "https://placehold.co/200x200?text=–ù–µ—Ç+—Ñ–æ—Ç–æ";
        const nm   = (p.title || "").replaceAll("<","&lt;");
        const meta = (p.desc  || "").slice(0,60).replaceAll("<","&lt;");
        return `
          <div class="aItem">
            <img src="${img}" alt="">
            <div class="aInfo">
              <div class="aName">${nm}</div>
              <div class="aMeta">${meta}</div>
            </div>
            <div class="aAct">
              <button class="iconBtn edit" data-edit="${p.id}">‚úèÔ∏è</button>
              <button class="iconBtn del"  data-del="${p.id}">üóëÔ∏è</button>
            </div>
          </div>`;
      }).join("");
      $("alist").querySelectorAll("[data-edit]").forEach(b =>
        b.addEventListener("click", () => startEdit(b.getAttribute("data-edit")))
      );
      $("alist").querySelectorAll("[data-del]").forEach(b =>
        b.addEventListener("click", () => doDelete(b.getAttribute("data-del")))
      );
    }

    function openForm(){
      $("panel").style.display   = "block";
      $("formTitle").textContent = "–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä";
      $("pid").value = $("ptitle").value = $("pdesc").value =
      $("plink").value = $("pimg").value = "";
      $("prev").style.display = "none";
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
    function closeForm(){ $("panel").style.display = "none"; }

    async function startEdit(id){
      const p = adminCache.find(x => x.id === id);
      if (!p) return;
      $("panel").style.display   = "block";
      $("formTitle").textContent = "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ";
      $("pid").value    = p.id;
      $("ptitle").value = p.title || "";
      $("pdesc").value  = p.desc  || "";
      $("plink").value  = p.link  || "";
      $("pimg").value   = "";
      if (p.image){ $("prev").src = p.image; $("prev").style.display = "block"; }
      else { $("prev").style.display = "none"; }
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    async function saveProduct(){
      const id    = $("pid").value;
      const title = $("ptitle").value.trim();
      const desc  = $("pdesc").value.trim();
      const link  = $("plink").value.trim() || "#";
      if (!title) return toast("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ");

      let image = null;
      const f = $("pimg").files?.[0];
      if (f){ toast("–°–∂–∏–º–∞—é —Ñ–æ—Ç–æ..."); image = await compressImage(f, 900, 0.78); }

      try{
        if (!id){
          toast("–°–æ—Ö—Ä–∞–Ω—è—é...");
          await addDoc(productsCol, {
            title, desc, link, image: image || "", createdAt: Date.now()
          });
          toast("‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω!");
        }else{
          toast("–û–±–Ω–æ–≤–ª—è—é...");
          const payload = { title, desc, link };
          if (image) payload.image = image;
          await updateDoc(doc(db,"products",id), payload);
          toast("‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ!");
        }
        closeForm();
        await loadAdminList();
        await loadProducts();
      }catch(e){
        toast("–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏: " + e.message, 5000);
      }
    }

    async function doDelete(id){
      if (!confirm("–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?")) return;
      try{
        await deleteDoc(doc(db,"products",id));
        toast("üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ");
        await loadAdminList();
        await loadProducts();
      }catch(e){
        toast("–û—à–∏–±–∫–∞: " + e.message, 4000);
      }
    }

    function doLogin(){
      const l = $("login").value.trim();
      const p = $("pass").value.trim();
      $("errMsg").style.display = "none";
      if (checkCreds(l, p)){
        sessionStorage.setItem("adm","1");
        $("login").value = "";
        $("pass").value  = "";
        show("screenAdmin");
        loadAdminList();
      }else{
        $("errMsg").style.display = "block";
      }
    }

    function doLogout(){
      sessionStorage.removeItem("adm");
      show("screenClient");
      toast("–í—ã –≤—ã—à–ª–∏");
    }

    $("gear").addEventListener("click", () => {
      if (sessionStorage.getItem("adm")){ show("screenAdmin"); loadAdminList(); }
      else { show("screenLogin"); }
    });
    $("btnLogin").addEventListener    ("click", doLogin);
    $("btnCancel").addEventListener   ("click", () => show("screenClient"));
    $("btnOpenForm").addEventListener ("click", openForm);
    $("btnCloseForm").addEventListener("click", closeForm);
    $("btnSave").addEventListener     ("click", saveProduct);
    $("btnLogout").addEventListener   ("click", doLogout);
    [$("login"), $("pass")].forEach(el =>
      el.addEventListener("keydown", e => { if (e.key === "Enter") doLogin(); })
    );

    // –°—Ç–∞—Ä—Ç
    if (sessionStorage.getItem("adm")){
      show("screenAdmin"); loadAdminList();
    }else{
      show("screenClient"); loadProducts();
    }

    // PWA
    const manifest = {
      name:"–î–µ—Ç—Å–∫–∞—è –û–¥–µ–∂–¥–∞", short_name:"–û–¥–µ–∂–¥–∞",
      start_url:"./", display:"standalone",
      background_color:"#fdf1f4", theme_color:"#e97a95",
      icons:[{ src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2U5N2E5NSIvPjwvc3ZnPg==", sizes:"192x192", type:"image/svg+xml" }]
    };
    const mLink = document.createElement("link");
    mLink.rel = "manifest";
    mLink.href = URL.createObjectURL(new Blob([JSON.stringify(manifest)],{type:"application/json"}));
    document.head.appendChild(mLink);

    if ("serviceWorker" in navigator){
      const sw = `
        self.addEventListener('install',  () => self.skipWaiting());
        self.addEventListener('activate', () => self.clients.claim());
        self.addEventListener('fetch', e => e.respondWith(fetch(e.request).catch(() => caches.match(e.request))));
      `;
      window.addEventListener("load", () =>
        navigator.serviceWorker.register(
          URL.createObjectURL(new Blob([sw],{type:"application/javascript"}))
        ).catch(()=>{})
      );
    }
  </script>
</body>
</html>
